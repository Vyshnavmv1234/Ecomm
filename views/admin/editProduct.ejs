<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Edit Product | WestLane</title>

<style>
/* ===== RESET ===== */
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family: "Inter", Arial, sans-serif;
}
.card{
  background:#fff;
  border-radius:12px;
  padding:25px;
  margin-bottom:25px;
}
.image-box{
  border:2px dashed #ddd;
  border-radius:12px;
  padding:40px;
  text-align:center;
  background:#fafafa;
}

.image-box p{
  font-size:13px;
  color:#777;
  margin:15px 0;
}

.image-box button{
  background:#ece7ff;
  border:none;
  padding:10px 16px;
  border-radius:8px;
  color:#5b4bdb;
  cursor:pointer;
}

body{
  background:#f6f6f8;
  min-height:100vh;
}

/* ===== MAIN ===== */
.main{
  margin-top: 60px;
  margin-left:230px; /* sidebar width */
  padding:30px 40px;
}

/* ===== TOP BAR ===== */
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  margin-bottom:25px;
}

.topbar h2{
  font-size:22px;
  font-weight:600;
}

.breadcrumb{
  font-size:13px;
  color:#888;
  margin-top:6px;
}

.actions{
  display:flex;
  gap:12px;
}

.btn{
  padding:10px 16px;
  border-radius:8px;
  font-size:14px;
  cursor:pointer;
  border:none;
}

.btn-cancel{
  background:#fff;
  border:1px solid #b0b6c3;
  color:#333;
}

.btn-primary{
  background:#c9b1a8;
  color:#fff;
}

/* ===== CARD ===== */
.card{
  background:#fff;
  border-radius:14px;
  padding:28px;
  max-width:900px;
}

/* ===== FORM ===== */
label{
  font-size:13px;
  color:#6b7280;
  display:block;
  margin-bottom:6px;
}

input, textarea{
  width:100%;
  padding:12px 14px;
  border-radius:8px;
  border:1px solid #e2e2e2;
  background:#fafafa;
  font-size:14px;
  margin-bottom:18px;
}

textarea{
  min-height:140px;
  resize:none;
}

/* ===== SECTION TITLE ===== */
.section-title{
  font-size:16px;
  font-weight:600;
  margin-bottom:20px;
}
</style>
</head>

<body>

<!-- HEADER -->
<%- include("../../views/partials/admin/header") %>

<!-- SIDEBAR -->
<%- include("../../views/partials/admin/sidebar") %>

<!-- MAIN -->
<div class="main">

  <!-- TOP BAR -->
  <div class="topbar">
    <div>
      <h2>Edit Product</h2>
      <div style="margin-bottom: 10px;" class="breadcrumb">
       › <a href="/admin/products">Products</a> › <a href="/admin/addProducts">Add Products</a> › <a href="/admin/editProduct">Edit Products</a>  › 
      </div>
    </div>
  </div>

  <!-- GENERAL INFORMATION -->
   <form id="formId">
  <div class="card">
    <div class="section-title">General Information</div>

    <label>Product Name</label>
    <input id="productId" name="productName" type="text" value="<%=product.name%>">

    <label>Description</label>
    <textarea id="descriptionId" name="productDescription">
      <%=product.description%>
      </textarea>
      
       <!-- GENERAL PHOTO (TITLE ONLY LIKE SCREENSHOT) -->
  <div class="card">
        <h3 style="margin-bottom:20px;">General Photo</h3>

        <div class="image-box">
          <p>Drag and drop image here, or click add image</p>
          <input id="imageInput" type="file" name="images" multiple>
          <button type="button">Add Image</button>
        </div>
      </div>

      <div class="actions">
        <button id="buttonId" type="submit" class="btn btn-primary">Save Product</button>
          <button class="btn btn-cancel">Cancel</button>
        </div>
  </div>
  </form>

 

</div>
<script>

 const form = document.getElementById("formId");

  form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const productId = "<%= product._id %>";
  const formData = new FormData();

  formData.append("name", document.getElementById("productId").value.trim());
  formData.append("description", document.getElementById("descriptionId").value.trim());

  const images = document.getElementById("imageInput").files;

  for (let img of images) {
    formData.append("images", img);
  }

  const res = await fetch(`/admin/updateProduct/${productId}`, {
    method: "PATCH",
    body: formData   
  });

  const data = await res.json();

  if (res.ok && data.success) {
    window.location.href = "/admin/products";
  } else {
    alert(data.message || "Failed to update product");
  }
});

</script>

</body>
</html>
